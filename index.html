<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Hot tweets</title>
  <!-- Latest compiled and minified CSS -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha384-BVYiiSIFeK1dGmJRAkycuHAHRg32OmUcww7on3RYdg4Va+PmSTsz/K68vbdEjh4u" crossorigin="anonymous">

  <!-- Optional theme -->
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap-theme.min.css" integrity="sha384-rHyoN1iRsVXV4nD0JutlnGaslCJuC7uwjduW9SVrLvRYooPp2bWYgmgJQIXwl/Sp" crossorigin="anonymous">

  <style>
  body {
    width: 500px;
    margin: auto;
    background-color: #c0deed;
  }
  h1 {
    text-align: center;
  }
  </style>


  <!-- Latest compiled and minified JavaScript -->
</head>

<body>

  <!-- <div class="container"> -->
    <!-- <div class="jumbotron">
      <h1>Bootstrap Tutorial</h1>
      <p>Bootstrap is the most popular HTML, CSS, and JS framework for developing
        responsive, mobile-first projects on the web.</p>
    </div> -->

    <div class="page-header">
      <h1>Hot Tweets</h1>
      <i class="fa fa-twitter-square" style="font-size:48px;color:red"></i>
    </div>

    <form>
      <div class="form-group">
        <!-- <label for="inputlg">Large input</label> -->
        <input class="form-control input-lg" id="twitterID" type="text" placeholder="Enter Twitter ID, such as nodejs, java, nytimes">
      </div>
    </form>


  <!-- </div> -->
  <!-- <div class="row">
    <blockquote class="twitter-tweet"><p lang="en" dir="ltr">Sunsets don&#39;t get much better than this one over <a href="https://twitter.com/GrandTetonNPS">@GrandTetonNPS</a>. <a href="https://twitter.com/hashtag/nature?src=hash">#nature</a> <a href="https://twitter.com/hashtag/sunset?src=hash">#sunset</a> <a href="http://t.co/YuKy2rcjyU">pic.twitter.com/YuKy2rcjyU</a></p>&mdash; US Dept of Interior (@Interior) <a href="https://twitter.com/Interior/status/463440424141459456">May 5, 2014</a></blockquote> <script async src="//platform.twitter.com/widgets.js" charset="utf-8"></script>
  </div> -->




<!-- <a class="twitter-timeline"  href="https://twitter.com/search?l=&q=from%3Anytimes&src=typd" data-widget-id="893515711133270016">關於 from:nytimes 的推文</a>
<script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script> -->

<!-- <a class="twitter-timeline"
href="https://twitter.com/nytimes"
data-height="400"
data-chrome="nofooter"
data-link-color="#820bbb"
data-border-color="#a80000">
Tweets by @TwitterDev
</a> -->
  <script src="https://platform.twitter.com/widgets.js"></script>
  <script
  src="http://code.jquery.com/jquery-3.2.1.min.js"
  integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
  crossorigin="anonymous"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script>

  <script>window.twttr = (function(d, s, id) {
    var js, fjs = d.getElementsByTagName(s)[0],
    t = window.twttr || {};
    if (d.getElementById(id)) return t;
    js = d.createElement(s);
    js.id = id;
    js.src = "https://platform.twitter.com/widgets.js";
    fjs.parentNode.insertBefore(js, fjs);

    t._e = [];
    t.ready = function(f) {
      t._e.push(f);
    };
    return t;
  }(document, "script", "twitter-wjs"));
  </script>

  <script>
  // twttr.widgets.createTimeline(
  //   "600756918018179072",
  //   document.getElementById("container"),
  //   {
  //     height: 400
  //   }
  // );

  // twttr.widgets.createTweet(
  // '892917207587487744',
  // document.getElementById('first-tweet'),
  // {
  //   align: 'left'
  // })
  // .then(function (el) {
  //   console.log("Tweet displayed.")
  // });

  //create
  var noShow = document.createElement('div');
  noShow.id = "noShow";
  noShow.style.display="none";
  noShow.innerHTML="<h2>Try something more popular!</h2>";
  document.body.appendChild(noShow);
  //create div for tweets
  var tweetNum = 10;
  for (var i=0; i<tweetNum; i++) {
    var g = document.createElement('div');
    g.id = `id${i}`;
    document.body.appendChild(g);
  }

  //ajax request
  // ("keyup", function(event) {
  //   event.preventDefault();
  //   if (event.keyCode == 13) {
  //       document.getElementById("id_of_button").click();
  //   }
  document.getElementById("twitterID").addEventListener("keypress", function(event) {
    console.log("OK");
    if (event.which == 13 || event.keyCode == 13) {
      event.preventDefault();
      // if (event.which == 13 || event.keyCode == 13) {
      var twitterID = document.getElementById("twitterID").value;
      // var twitterID = "nytimes";
      var url = "http://54.202.23.65:3000/hot?twitterID="+twitterID;
      $.getJSON( url, function( data ) {
        console.log(data);
        var p = data;
        noShow.style.display= (data.length === 0) ? "" : "none";
        for (var i=0; i<tweetNum; i++) {
          document.getElementById(`id${i}`).innerHTML = ""; // clear div
          twttr.widgets.createTweet( // twitter api
            data[i],
            document.getElementById(`id${i}`),
            {
              align: 'left'
            })
            .then(function (el) {
              console.log("Tweet displayed.")
            });
          }
        }).fail(function() {
          console.log( "Tweets Could Not Be Loaded." );
        });
        return false;
      }
      // }
    });


  </script>
</body>
</html>
